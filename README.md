# Explainable Machine Learning for Characterizing Unknown Molecular Structures in Infrared Spectra

## Abstract

Various machine learning methods for detecting functional groups in infrared (IR) spectra have been developed to accelerate time-consuming and labor-intensive IR spectrum analysis. However, existing machine learning methods have two fundamental limitations: (1) They do not utilize prior knowledge in IR spectrum analysis in training and inference processes. (2) Their prediction results are not explainable. To overcome these limitations, we propose a deep learning method called Substructure-directed Spectrum Interpreter Network (SSIN) for efficient and explainable functional group detection in IR spectra of unknown molecules. SSIN achieved a detection accuracy greater than 0.920 on the NIST database, which contains experimentally measured 8,845 gas-phase IR spectra. Furthermore, SSIN accurately identified the absorption peaks associated with the existence of target functional groups. Quantitatively, human-readable IR spectrum reports generated by SSIN with large language models (LLMs) are consistent with a ground-truth IR spectroscopy absorption table with 81-99\% accuracy.

*Note that the IR spectrum images in the uploaded analysis reports were removed due to license issues.*

---

## Usage

- ``train_ssin.py``: Train and evaluate SSIN based on k-fold cross validation.
- ``exec_ssin.py``: Execute the trained SSIN model to calculate detection labels and important absorption peaks. Then, make an IR spectrum analysis report through SSIN-LLM.

---

## Dataset

The IR spectrum dataset is available at https://webbook.nist.gov/chemistry
